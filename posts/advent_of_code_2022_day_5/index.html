<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Advent of Code In BigQuery - Day 5 - Peter Boone</title><meta name=keywords content="tech,bigquery,google"><meta name=description content="Oof, this one was rough. This may be the start of the end for my SQL Advent of Code journey. I tried a few different approaches before &ldquo;cheating&rdquo; and falling back on a Javascript UDF. This code is a mess and I would definitly not recommend reading it. I don&rsquo;t have the stomach to go back and read it myself to clean it up.
CREATE TEMP FUNCTION move_box(directions ARRAY<STRUCT<quantity INT64, move_from INT64, move_to INT64>>, start_positions ARRAY<STRUCT<c INT64, value STRING>>) RETURNS STRING LANGUAGE js AS r&#34;&#34;&#34; let x = {}; for (let i = 0; i < start_positions."><meta name=author content="Peter Boone"><link rel=canonical href=https://boonepeter.github.io/posts/advent_of_code_2022_day_5/><link href=https://boonepeter.github.io/assets/css/stylesheet.min.69a0a2b5ef2f62289117c5e7895b832df501978d8dfb1274dc90509d9924b2bb.css integrity="sha256-aaCite8vYiiRF8XniVuDLfUBl42N+xJ03JBQnZkksrs=" rel="preload stylesheet" as=style><link rel=manifest href=https://boonepeter.github.io/site.webmanifest><link rel=icon href=https://boonepeter.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://boonepeter.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://boonepeter.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://boonepeter.github.io/apple-touch-icon.png><link rel=mask-icon href=https://boonepeter.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.107.0"><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-125699184-1","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script><meta property="og:title" content="Advent of Code In BigQuery - Day 5"><meta property="og:description" content="Oof, this one was rough. This may be the start of the end for my SQL Advent of Code journey. I tried a few different approaches before &ldquo;cheating&rdquo; and falling back on a Javascript UDF. This code is a mess and I would definitly not recommend reading it. I don&rsquo;t have the stomach to go back and read it myself to clean it up.
CREATE TEMP FUNCTION move_box(directions ARRAY<STRUCT<quantity INT64, move_from INT64, move_to INT64>>, start_positions ARRAY<STRUCT<c INT64, value STRING>>) RETURNS STRING LANGUAGE js AS r&#34;&#34;&#34; let x = {}; for (let i = 0; i < start_positions."><meta property="og:type" content="article"><meta property="og:url" content="https://boonepeter.github.io/posts/advent_of_code_2022_day_5/"><meta property="article:published_time" content="2022-12-05T00:00:00+00:00"><meta property="article:modified_time" content="2022-12-05T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Advent of Code In BigQuery - Day 5"><meta name=twitter:description content="Oof, this one was rough. This may be the start of the end for my SQL Advent of Code journey. I tried a few different approaches before &ldquo;cheating&rdquo; and falling back on a Javascript UDF. This code is a mess and I would definitly not recommend reading it. I don&rsquo;t have the stomach to go back and read it myself to clean it up.
CREATE TEMP FUNCTION move_box(directions ARRAY<STRUCT<quantity INT64, move_from INT64, move_to INT64>>, start_positions ARRAY<STRUCT<c INT64, value STRING>>) RETURNS STRING LANGUAGE js AS r&#34;&#34;&#34; let x = {}; for (let i = 0; i < start_positions."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Advent of Code In BigQuery - Day 5","name":"Advent of Code In BigQuery - Day 5","description":"Oof, this one was rough. This may be the start of the end for my SQL Advent of Code journey. I tried a few different approaches before \u0026amp;ldquo;cheating\u0026amp;rdquo; and falling back on a …","keywords":["tech","bigquery","google"],"articleBody":"Oof, this one was rough. This may be the start of the end for my SQL Advent of Code journey. I tried a few different approaches before “cheating” and falling back on a Javascript UDF. This code is a mess and I would definitly not recommend reading it. I don’t have the stomach to go back and read it myself to clean it up.\nCREATE TEMP FUNCTION move_box(directions ARRAY\u003cSTRUCT\u003cquantity INT64, move_from INT64, move_to INT64\u003e\u003e, start_positions ARRAY\u003cSTRUCT\u003cc INT64, value STRING\u003e\u003e) RETURNS STRING LANGUAGE js AS r\"\"\" let x = {}; for (let i = 0; i \u003c start_positions.length; i++) { const item = start_positions[i]; if (!(item.c in x)) { x[item.c] = [item.value] } else { x[item.c].push(item.value) } } for (let i = 0; i \u003c directions.length; i++) { const item = directions[i]; const values = x[item.move_from - 1].slice(-item.quantity); // comment out for part 2 //values.reverse(); x[item.move_from - 1] = x[item.move_from - 1].slice(0, -item.quantity) for (let j = 0; j \u003c values.length; j++) { x[item.move_to - 1].push(values[j]); } } return Object.keys(x).map(k =\u003e x[k].pop()).join(''); \"\"\"; WITH raw_input AS ( SELECT \"\"\" [D] [N] [C] [Z] [M] [P] 1 2 3 move 1 from 2 to 1 move 3 from 1 to 3 move 2 from 2 to 1 move 1 from 1 to 2\"\"\" AS raw_text ), raw_rows AS ( SELECT o, raw_row FROM ( SELECT SPLIT(raw_text, '\\n') raw_row_array FROM raw_input ), UNNEST(raw_row_array) raw_row WITH OFFSET o ), parsed as ( SELECT *, IF(raw_row like 'move%', REGEXP_EXTRACT_ALL(raw_row, r'\\d+'), []) AS directions FROM raw_rows ), split_input AS ( SELECT TO_CODE_POINTS(raw_row) s, o as r, raw_row FROM raw_rows WHERE raw_row LIKE '%[%' ), grouped_in AS ( SELECT CHR(i) as char, o, r, raw_row FROM split_input, UNNEST(s) i WITH OFFSET o ), grouped_input AS ( SELECT STRING_AGG(char, '') OVER (PARTITION BY DIV(o, 4), r ORDER BY r, o) box, o, r FROM grouped_in ), final_boxes AS ( select o, r, REGEXP_EXTRACT(box, r'\\w') as box from grouped_input WHERE MOD(o, 4) = 2 ), directions as ( SELECT STRUCT( CAST(directions[OFFSET(0)] AS INT) as quantity, CAST(directions[OFFSET(1)] AS INT) as move_from, CAST(directions[OFFSET(2)] AS INT) AS move_to ) AS direction FROM parsed WHERE ARRAY_LENGTH(directions) \u003e 0 ), box_rows AS ( SELECT box, DIV(o, 4) AS c, r FROM final_boxes ), box_columns AS ( SELECT box as value, c FROM box_rows WHERE box \u003c\u003e ' ' ORDER BY c, r DESC ), box_arrays AS ( SELECT ARRAY_AGG( STRUCT( c, value ) ) AS boxes FROM box_columns ), array_directions AS ( SELECT ARRAY_AGG(direction) directions FROM directions ) SELECT move_box(directions, boxes) FROM array_directions JOIN box_arrays ON TRUE ","wordCount":"423","inLanguage":"en","datePublished":"2022-12-05T00:00:00Z","dateModified":"2022-12-05T00:00:00Z","author":{"@type":"Person","name":"Peter Boone"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://boonepeter.github.io/posts/advent_of_code_2022_day_5/"},"publisher":{"@type":"Organization","name":"Peter Boone","logo":{"@type":"ImageObject","url":"https://boonepeter.github.io/favicon.ico"}}}</script></head><body class=single id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><noscript><style type=text/css>.theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://boonepeter.github.io/ accesskey=h>Peter Boone</a>
<span class=logo-switches><span class=theme-toggle><a id=theme-toggle accesskey=t><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></a></span></span></div><ul class=menu id=menu onscroll=menu_on_scroll()><li><a href=https://boonepeter.github.io/archive/><span>Archives</span></a></li><li><a href=https://boonepeter.github.io/tags/><span>Tags</span></a></li><li><a href=https://buttondown.email/boonepeter><span>Subscribe</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Advent of Code In BigQuery - Day 5</h1><div class=post-meta>December 5, 2022&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Peter Boone
&nbsp;·&nbsp;<a href=https://github.com/boonepeter/boonepeter.github.io/blob/master/content/posts/advent_of_code_2022_day_5.md>Source</a></div></header><div class=post-content><p>Oof, this one was rough. This may be the start of the end for my SQL Advent of Code journey. I tried a few different approaches before &ldquo;cheating&rdquo; and falling back on a Javascript UDF. This code is a mess and I would definitly not recommend reading it. I don&rsquo;t have the stomach to go back and read it myself to clean it up.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> TEMP <span style=color:#66d9ef>FUNCTION</span> move_box(directions ARRAY<span style=color:#f92672>&lt;</span>STRUCT<span style=color:#f92672>&lt;</span>quantity INT64, move_from INT64, move_to INT64<span style=color:#f92672>&gt;&gt;</span>, start_positions ARRAY<span style=color:#f92672>&lt;</span>STRUCT<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>c</span> INT64, value STRING<span style=color:#f92672>&gt;&gt;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>RETURNS</span> STRING
</span></span><span style=display:flex><span><span style=color:#66d9ef>LANGUAGE</span> js
</span></span><span style=display:flex><span><span style=color:#66d9ef>AS</span> r<span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  let x = {};
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  for (let i = 0; i &lt; start_positions.length; i++) {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    const item = start_positions[i];
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    if (!(item.c in x)) {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      x[item.c] = [item.value]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    } else {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      x[item.c].push(item.value)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  for (let i = 0; i &lt; directions.length; i++) {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    const item = directions[i];
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    const values = x[item.move_from - 1].slice(-item.quantity);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    // comment out for part 2
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    //values.reverse();
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    x[item.move_from - 1] = x[item.move_from - 1].slice(0, -item.quantity)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    for (let j = 0; j &lt; values.length; j++) {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      x[item.move_to - 1].push(values[j]); 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  return Object.keys(x).map(k =&gt; x[k].pop()).join(&#39;&#39;);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WITH</span>
</span></span><span style=display:flex><span>  raw_input <span style=color:#66d9ef>AS</span> (
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;&#34;&#34;    [D]    
</span></span></span><span style=display:flex><span><span style=color:#e6db74>[N] [C]    
</span></span></span><span style=display:flex><span><span style=color:#e6db74>[Z] [M] [P]
</span></span></span><span style=display:flex><span><span style=color:#e6db74> 1   2   3 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>move 1 from 2 to 1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>move 3 from 1 to 3
</span></span></span><span style=display:flex><span><span style=color:#e6db74>move 2 from 2 to 1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>move 1 from 1 to 2&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>AS</span> raw_text ),
</span></span><span style=display:flex><span>raw_rows <span style=color:#66d9ef>AS</span> (
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>    o,
</span></span><span style=display:flex><span>    raw_row
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>FROM</span> (
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>      SPLIT(raw_text, <span style=color:#e6db74>&#39;\n&#39;</span>) raw_row_array
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>FROM</span>
</span></span><span style=display:flex><span>      raw_input ),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>UNNEST</span>(raw_row_array) raw_row <span style=color:#66d9ef>WITH</span> <span style=color:#66d9ef>OFFSET</span> o
</span></span><span style=display:flex><span>), parsed <span style=color:#66d9ef>as</span> (
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>SELECT</span> 
</span></span><span style=display:flex><span>    <span style=color:#f92672>*</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>IF</span>(raw_row <span style=color:#66d9ef>like</span> <span style=color:#e6db74>&#39;move%&#39;</span>, REGEXP_EXTRACT_ALL(raw_row, r<span style=color:#e6db74>&#39;\d+&#39;</span>), []) <span style=color:#66d9ef>AS</span> directions
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>FROM</span> raw_rows
</span></span><span style=display:flex><span>), 
</span></span><span style=display:flex><span>split_input <span style=color:#66d9ef>AS</span> (
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>    TO_CODE_POINTS(raw_row) s,
</span></span><span style=display:flex><span>    o <span style=color:#66d9ef>as</span> r,
</span></span><span style=display:flex><span>    raw_row
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>FROM</span> raw_rows
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>WHERE</span> raw_row <span style=color:#66d9ef>LIKE</span> <span style=color:#e6db74>&#39;%[%&#39;</span>
</span></span><span style=display:flex><span>),
</span></span><span style=display:flex><span>grouped_in <span style=color:#66d9ef>AS</span> (
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>    CHR(i) <span style=color:#66d9ef>as</span> char,
</span></span><span style=display:flex><span>    o,
</span></span><span style=display:flex><span>    r,
</span></span><span style=display:flex><span>    raw_row
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>FROM</span> split_input,
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>UNNEST</span>(s) i <span style=color:#66d9ef>WITH</span> <span style=color:#66d9ef>OFFSET</span> o
</span></span><span style=display:flex><span>),
</span></span><span style=display:flex><span>grouped_input <span style=color:#66d9ef>AS</span> (
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>    STRING_AGG(char, <span style=color:#e6db74>&#39;&#39;</span>) OVER (PARTITION <span style=color:#66d9ef>BY</span> DIV(o, <span style=color:#ae81ff>4</span>), r <span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> r, o) box,
</span></span><span style=display:flex><span>    o,
</span></span><span style=display:flex><span>    r
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>FROM</span> grouped_in    
</span></span><span style=display:flex><span>),
</span></span><span style=display:flex><span>final_boxes <span style=color:#66d9ef>AS</span> (
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>select</span> o, r, REGEXP_EXTRACT(box, r<span style=color:#e6db74>&#39;\w&#39;</span>) <span style=color:#66d9ef>as</span> box
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>from</span> grouped_input
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>WHERE</span> <span style=color:#66d9ef>MOD</span>(o, <span style=color:#ae81ff>4</span>) <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>),
</span></span><span style=display:flex><span>directions <span style=color:#66d9ef>as</span> (
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>    STRUCT(
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>CAST</span>(directions[<span style=color:#66d9ef>OFFSET</span>(<span style=color:#ae81ff>0</span>)] <span style=color:#66d9ef>AS</span> INT) <span style=color:#66d9ef>as</span> quantity,
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>CAST</span>(directions[<span style=color:#66d9ef>OFFSET</span>(<span style=color:#ae81ff>1</span>)] <span style=color:#66d9ef>AS</span> INT) <span style=color:#66d9ef>as</span> move_from,
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>CAST</span>(directions[<span style=color:#66d9ef>OFFSET</span>(<span style=color:#ae81ff>2</span>)] <span style=color:#66d9ef>AS</span> INT) <span style=color:#66d9ef>AS</span> move_to
</span></span><span style=display:flex><span>    ) <span style=color:#66d9ef>AS</span> direction
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>FROM</span> parsed
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>WHERE</span> ARRAY_LENGTH(directions) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>),
</span></span><span style=display:flex><span>box_rows <span style=color:#66d9ef>AS</span> (
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>    box,
</span></span><span style=display:flex><span>    DIV(o, <span style=color:#ae81ff>4</span>) <span style=color:#66d9ef>AS</span> <span style=color:#66d9ef>c</span>,
</span></span><span style=display:flex><span>    r
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>FROM</span> final_boxes
</span></span><span style=display:flex><span>), box_columns <span style=color:#66d9ef>AS</span> (
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>    box <span style=color:#66d9ef>as</span> value,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>c</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>FROM</span> box_rows
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>WHERE</span> box <span style=color:#f92672>&lt;&gt;</span> <span style=color:#e6db74>&#39; &#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> <span style=color:#66d9ef>c</span>, r <span style=color:#66d9ef>DESC</span>
</span></span><span style=display:flex><span>), box_arrays <span style=color:#66d9ef>AS</span> (
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>    ARRAY_AGG(
</span></span><span style=display:flex><span>      STRUCT(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>c</span>,
</span></span><span style=display:flex><span>        value
</span></span><span style=display:flex><span>      )
</span></span><span style=display:flex><span>    ) <span style=color:#66d9ef>AS</span> boxes
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>FROM</span> box_columns
</span></span><span style=display:flex><span>), array_directions <span style=color:#66d9ef>AS</span> (
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>SELECT</span> ARRAY_AGG(direction) directions
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>FROM</span> directions
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> 
</span></span><span style=display:flex><span>  move_box(directions, boxes)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> array_directions
</span></span><span style=display:flex><span><span style=color:#66d9ef>JOIN</span> box_arrays
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> <span style=color:#66d9ef>TRUE</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://boonepeter.github.io/tags/tech>tech</a></li><li><a href=https://boonepeter.github.io/tags/bigquery>bigquery</a></li><li><a href=https://boonepeter.github.io/tags/google>google</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://boonepeter.github.io/>Peter Boone</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span>
<span>&#183;</span>
<span><a href=https://buttondown.email/boonepeter>Subscribe</a></span></footer><a href=#top aria-label="go to top" title="Go to Top" accesskey=g><button class=top-link id=top-link type=button><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6"><path d="M12 6H0l6-6z"/></svg></button></a>
<script src=https://boonepeter.github.io/assets/js/highlight.min.14feb2f019bbfe400c73e169354bb5dcbfab5cd41b3ee05da4cb155870a2914b.js integrity="sha256-FP6y8Bm7/kAMc+FpNUu13L+rXNQbPuBdpMsVWHCikUs="></script>
<script>hljs.initHighlightingOnLoad()</script><script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById("menu").scrollLeft=localStorage.getItem("menu-scroll-position"))},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);document.querySelector(`[id='${t}']`).scrollIntoView({behavior:"smooth"})})});var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById("menu").scrollLeft)}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>